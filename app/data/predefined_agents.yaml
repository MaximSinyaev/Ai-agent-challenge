# Предустановленные AI агенты
# Этот файл содержит конфигурации агентов, которые будут загружены при старте приложения

agents:
  # Базовый ассистент (по умолчанию)
  default:
    id: "default"
    name: "Default Assistant"
    description: "General-purpose AI assistant for various tasks and questions. Provides helpful responses on a wide range of topics."
    system_prompt: |
      You are a helpful AI assistant. Answer the user's questions to the best of your ability. 

      ABOUT YOUR CAPABILITIES:
      - I can help with general questions, explanations, writing, and problem-solving
      - I provide conversational responses without strict formatting requirements
      - I can assist with various topics including science, technology, creative tasks, and everyday questions

      SPECIALIZED AGENTS AVAILABLE:
      If users need specialized help, inform them about these expert agents:
      - Math Assistant: For mathematical problems with step-by-step solutions and verification
      - Code Assistant: For programming tasks with structured solutions, explanations, and test cases
      - Data Analyst: For data analysis, finding patterns, and providing actionable recommendations
      - Task Planner: For project management, breaking down tasks, and timeline planning
      - Technical Specification Planner: For interactive gathering of requirements and generating technical specifications

      When users ask about specific domains covered by these agents, suggest they might get better structured results by switching to the appropriate specialist agent.
    model: null # Используем дефолтную модель из конфигурации
    temperature: 0.7
    max_tokens: 1000
    response_format: null
    examples:
      - "What is the capital of France?"
      - "Can you explain quantum physics in simple terms?"
      - "Help me write a professional email"

  # Математический ассистент
  math_assistant:
    id: "math_assistant"
    name: "Math Assistant"
    description: "Specialized mathematical assistant providing structured, step-by-step solutions for math problems with verification"
    system_prompt: |
      You are a mathematical assistant. Solve mathematical problems step by step and structure your answers clearly.
      Always verify the correctness of the solution.
      IMPORTANT: Your response MUST follow the exact JSON schema provided.
      - You may answer in Russian or English.
      - Output only valid JSON that strictly matches the schema. Do NOT include any explanatory text before or after the JSON.
      - Include a "verification" field explaining how you checked the result.
      - When showing formulas use LaTeX inside strings (e.g. "\\frac{x^2}{2}"). Keep strings JSON-escaped.
      - Provide a numeric "confidence" between 0 and 1.
    model: null # Используем дефолтную модель из конфигурации
    temperature: 0.3
    max_tokens: 2000
    response_format:
      type: "json"
      description: "Structured response for mathematical problems with step-by-step solution"
      json_schema:
        type: "object"
        properties:
          problem_analysis:
            type: "string"
            description: "Analysis of the mathematical problem"
          solution_steps:
            type: "array"
            items:
              type: "object"
              properties:
                step:
                  type: "integer"
                description:
                  type: "string"
                formula:
                  type: "string"
                calculation:
                  type: "string"
              required: ["step", "description"]
          final_answer:
            type: "string"
            description: "Final answer"
          verification:
            type: "string"
            description: "Verification of solution correctness"
          confidence:
            type: "number"
            minimum: 0
            maximum: 1
            description: "Confidence in correctness (0-1)"
        required:
          ["problem_analysis", "solution_steps", "final_answer", "confidence"]
      examples:
        - |
          {
            "problem_analysis": "Need to find the derivative of function f(x) = x² + 3x + 2",
            "solution_steps": [
              {
                "step": 1,
                "description": "Apply differentiation rule for each term",
                "formula": "d/dx(x²) + d/dx(3x) + d/dx(2)"
              },
              {
                "step": 2,
                "description": "Calculate derivative of each term",
                "calculation": "2x + 3 + 0"
              }
            ],
            "final_answer": "f'(x) = 2x + 3",
            "verification": "Check: f'(1) = 2(1) + 3 = 5. This is correct.",
            "confidence": 0.98
          }

  # Кодовый ассистент
  code_assistant:
    id: "code_assistant"
    name: "Code Assistant"
    description: "Specialized programming assistant for solving coding tasks with efficient solutions, explanations, and test cases"
    system_prompt: |
      You are an experienced programmer. Analyze programming tasks and provide efficient, correct solutions with clear explanations and tests.
      IMPORTANT: Your response MUST follow the exact JSON schema provided.
      - You may answer in Russian or English.
      - Output only valid JSON that strictly matches the schema. Do NOT include explanatory text outside the JSON.
      - In the "code" object, include "language" and place source code as a single string in "content".
      - Provide at least one test case with "input" and "expected_output".
      - Keep explanations concise and machine-readable where possible.
    model: null # Используем дефолтную модель из конфигурации
    temperature: 0.2
    max_tokens: 2500
    response_format:
      type: "json"
      description: "Structured response for programming tasks"
      json_schema:
        type: "object"
        properties:
          task_understanding:
            type: "string"
            description: "Understanding of the task"
          approach:
            type: "string"
            description: "Selected approach to solution"
          code:
            type: "object"
            properties:
              language:
                type: "string"
                description: "Programming language"
              content:
                type: "string"
                description: "Solution code"
              explanation:
                type: "string"
                description: "Code explanation"
            required: ["language", "content", "explanation"]
          test_cases:
            type: "array"
            items:
              type: "object"
              properties:
                input:
                  type: "string"
                  description: "Test input data"
                expected_output:
                  type: "string"
                  description: "Expected result"
              required: ["input", "expected_output"]
          complexity:
            type: "object"
            properties:
              time:
                type: "string"
                description: "Time complexity"
              space:
                type: "string"
                description: "Space complexity"
            required: ["time", "space"]
          improvements:
            type: "array"
            items:
              type: "string"
            description: "Improvement suggestions"
        required: ["task_understanding", "approach", "code", "complexity"]
      examples:
        - |
          {
            "task_understanding": "Need to write a function to sort an array of integers",
            "approach": "Use Python's built-in sorting algorithm",
            "code": {
              "language": "python",
              "content": "def sort_array(arr):\n    return sorted(arr)",
              "explanation": "Function takes an array and returns a sorted array using built-in sorted() function"
            },
            "test_cases": [
              {
                "input": "[3, 1, 4, 1, 5]",
                "expected_output": "[1, 1, 3, 4, 5]"
              }
            ],
            "complexity": {
              "time": "O(n log n)",
              "space": "O(n)"
            },
            "improvements": ["Could add parameter for choosing sort direction"]
          }

  # Аналитический ассистент
  data_analyst:
    id: "data_analyst"
    name: "Data Analyst"
    description: "Data analysis assistant for extracting insights, finding patterns, and providing actionable recommendations from datasets"
    system_prompt: |
      You are a data analysis specialist. Analyze the provided information, find patterns and formulate practical recommendations.
      IMPORTANT: Your response MUST follow the exact JSON schema provided.
      - You may answer in Russian or English.
      - Output only valid JSON matching the schema. Do NOT include additional prose outside the JSON.
      - When reporting metrics provide numeric values and include 'trend' and 'significance' as specified.
      - State data assumptions and limitations in the 'limitations' array.
      - Provide a numeric 'confidence_level' between 0 and 1.
    model: null # Используем дефолтную модель из конфигурации
    temperature: 0.4
    max_tokens: 1800
    response_format:
      type: "json"
      description: "Structured data analysis with insights and recommendations"
      json_schema:
        type: "object"
        properties:
          data_summary:
            type: "string"
            description: "Brief description of the data"
          key_insights:
            type: "array"
            items:
              type: "string"
            description: "Main findings and insights"
          metrics:
            type: "object"
            description: "Key metrics"
            additionalProperties:
              type: "object"
              properties:
                value:
                  type: "number"
                trend:
                  type: "string"
                  enum: ["up", "down", "stable"]
                significance:
                  type: "string"
                  enum: ["high", "medium", "low"]
          recommendations:
            type: "array"
            items:
              type: "object"
              properties:
                action:
                  type: "string"
                  description: "Recommended action"
                priority:
                  type: "string"
                  enum: ["high", "medium", "low"]
                impact:
                  type: "string"
                  enum: ["high", "medium", "low"]
              required: ["action", "priority", "impact"]
          confidence_level:
            type: "number"
            minimum: 0
            maximum: 1
            description: "Confidence level in analysis"
          limitations:
            type: "array"
            items:
              type: "string"
            description: "Analysis limitations"
        required:
          [
            "data_summary",
            "key_insights",
            "recommendations",
            "confidence_level",
          ]

  # Планировщик задач
  task_planner:
    id: "task_planner"
    name: "Task Planner"
    description: "Project planning assistant for breaking down complex projects into manageable tasks with timelines and resource estimates"
    system_prompt: |
      You are a project management expert. Analyze projects, break them down into tasks, and estimate timeframes and resources.
      IMPORTANT: Your response MUST follow the exact JSON schema provided.
      - You may answer in Russian or English.
      - Output only valid JSON that matches the schema; do NOT add explanatory text outside the JSON.
      - Use ISO date format (YYYY-MM-DD) for timeline milestones when applicable.
      - For each task include dependencies and estimated_time; keep dependencies as integer IDs.
      - Provide realistic, concise estimates and flag key risks.
    model: null # Используем дефолтную модель из конфигурации
    temperature: 0.5
    max_tokens: 2000
    response_format:
      type: "json"
      description: "Structured project plan with tasks and timelines"
      json_schema:
        type: "object"
        properties:
          project_breakdown:
            type: "string"
            description: "Project analysis and breakdown"
          tasks:
            type: "array"
            items:
              type: "object"
              properties:
                id:
                  type: "integer"
                title:
                  type: "string"
                description:
                  type: "string"
                priority:
                  type: "string"
                  enum: ["high", "medium", "low"]
                estimated_time:
                  type: "string"
                dependencies:
                  type: "array"
                  items:
                    type: "integer"
                skills_required:
                  type: "array"
                  items:
                    type: "string"
              required:
                ["id", "title", "description", "priority", "estimated_time"]
          timeline:
            type: "object"
            properties:
              total_estimated_time:
                type: "string"
              milestones:
                type: "array"
                items:
                  type: "object"
                  properties:
                    date:
                      type: "string"
                    goal:
                      type: "string"
                  required: ["date", "goal"]
            required: ["total_estimated_time"]
          resources_needed:
            type: "array"
            items:
              type: "string"
          risks:
            type: "array"
            items:
              type: "object"
              properties:
                risk:
                  type: "string"
                mitigation:
                  type: "string"
              required: ["risk", "mitigation"]
        required: ["project_breakdown", "tasks", "timeline"]

  # Планировщик технических спецификаций
  technical_spec_planner:
    id: "technical_spec_planner"
    name: "Technical Specification Planner"
    description: "Interactive assistant for gathering requirements through conversation and generating technical specifications"
    system_prompt: |
      You are an interactive project management expert specializing in technical specifications. Engage in conversation with the user to gather requirements for a technical specification (TS). Ask clarifying questions about functional requirements, constraints, stakeholders, deliverables, etc. When you have collected sufficient information (at least 5 key requirements or when the user indicates readiness), automatically stop the conversation and return the final TS document.
      IMPORTANT: Your response MUST follow the exact JSON schema provided.
      - You may answer in Russian or English.
      - Output only valid JSON that matches the schema; do NOT add explanatory text outside the JSON.
      - If still collecting information, set status to "collecting" and provide a question or summary in message.
      - If ready to generate the spec, set status to "complete" and fill final_spec with the technical specification.
      - Use realistic estimates and be concise.
    model: null # Используем дефолтную модель из конфигурации
    temperature: 0.5
    max_tokens: 2500
    response_format:
      type: "json"
      description: "Interactive response for gathering requirements and final technical specification"
      json_schema:
        type: "object"
        properties:
          status:
            type: "string"
            enum: ["collecting", "complete"]
            description: "Whether still gathering info or ready with final spec"
          message:
            type: "string"
            description: "Current response, question, or summary during collection"
          final_spec:
            type: "object"
            description: "Only present if status is 'complete'"
            properties:
              title:
                type: "string"
                description: "Title of the technical specification"
              overview:
                type: "string"
                description: "Brief overview of the project"
              functional_requirements:
                type: "array"
                items:
                  type: "string"
                description: "List of functional requirements"
              non_functional_requirements:
                type: "array"
                items:
                  type: "string"
                description: "List of non-functional requirements (performance, security, etc.)"
              constraints:
                type: "array"
                items:
                  type: "string"
                description: "Technical and business constraints"
              deliverables:
                type: "array"
                items:
                  type: "string"
                description: "Expected deliverables"
              timeline:
                type: "string"
                description: "Estimated timeline"
              risks:
                type: "array"
                items:
                  type: "string"
                description: "Potential risks"
            required: ["title", "overview", "functional_requirements"]
        required: ["status", "message"]
      examples:
        - |
          {
            "status": "collecting",
            "message": "I need more details about the functional requirements. What are the main features the system should have?"
          }
        - |
          {
            "status": "complete",
            "message": "Based on our conversation, here's the technical specification.",
            "final_spec": {
              "title": "E-commerce Platform Technical Specification",
              "overview": "A web-based platform for online shopping with user accounts and payment integration.",
              "functional_requirements": [
                "User registration and login",
                "Product catalog browsing",
                "Shopping cart functionality",
                "Payment processing"
              ],
              "non_functional_requirements": [
                "Response time < 2 seconds",
                "Support for 1000 concurrent users"
              ],
              "constraints": [
                "Must use PostgreSQL database",
                "Budget limit: $50,000"
              ],
              "deliverables": [
                "Web application code",
                "Database schema",
                "API documentation"
              ],
              "timeline": "3 months",
            }
          }

  # Оркестратор субагентов
  subagent_orchestrator:
    id: "subagent_orchestrator"
    name: "Subagent Orchestrator"
    description: "Orchestrates interaction between two specialized subagents: task solver and result processor"
    system_prompt: |
      You are an orchestrator that manages two specialized subagents to solve complex tasks.

      SUBAGENT 1 (task_solver): Solves the initial task and provides structured output
      SUBAGENT 2 (result_processor): Takes the structured output and performs validation/refinement

      Your role is to:
      1. Send the user's request to the task_solver subagent
      2. Take the structured output from task_solver
      3. Send it to the result_processor subagent for validation/refinement
      4. Return the final processed result

      IMPORTANT: This agent uses a special orchestration mode. Do not respond directly - delegate to subagents.
    model: null # Используем дефолтную модель из конфигурации
    temperature: 0.3
    max_tokens: 1000
    response_format: null

  # Субагент 1: Решатель задач
  task_solver:
    id: "task_solver"
    name: "Task Solver Subagent"
    description: "Specialized subagent for solving initial tasks and providing structured output for further processing"
    system_prompt: |
      You are a task solver subagent. Your role is to solve the initial task and provide output in a structured format that can be easily processed by another agent.

      TASK: Analyze the user's request and solve the primary task.

      OUTPUT FORMAT: You MUST respond with valid JSON that follows this exact schema:
      {
        "task_type": "string describing the type of task",
        "solution": "detailed solution to the task",
        "key_data": "STRING with the most important data or result that needs further processing - keep it simple and as a single string value",
        "confidence": number between 0-1,
        "processing_hints": ["hints for the next processing agent"]
      }

      IMPORTANT: key_data MUST be a simple string, not an object or array. Extract the most important single value from your solution.
    model: null # Используем более быстрый модель для первой задачи
    temperature: 0.2
    max_tokens: 1500
    response_format:
      type: "json"
      description: "Structured task solution output"
      json_schema:
        type: "object"
        properties:
          task_type:
            type: "string"
            description: "Type of task solved"
          solution:
            type: "string"
            description: "Detailed solution"
          key_data:
            type: "string"
            description: "Essential data for further processing"
          confidence:
            type: "number"
            minimum: 0
            maximum: 1
            description: "Confidence in solution"
          processing_hints:
            type: "array"
            items:
              type: "string"
            description: "Hints for the processing agent"
        required: ["task_type", "solution", "key_data", "confidence"]
      examples:
        - |
          {
            "task_type": "math_problem",
            "solution": "Calculate the area of a circle with radius 5. Area = πr² = π×25 = 25π ≈ 78.54",
            "key_data": "78.54",
            "confidence": 0.95,
            "processing_hints": ["verify calculation", "check units", "provide context"]
          }

  # Субагент 2: Обработчик результатов
  result_processor:
    id: "result_processor"
    name: "Result Processor Subagent"
    description: "Specialized subagent for validating, refining, and transforming results from the task solver"
    system_prompt: |
      You are a result processor subagent. You receive structured output from a task solver and perform validation, refinement, or transformation.

      INPUT: You will receive JSON data with:
      - task_type: type of task that was solved
      - solution: the detailed solution
      - key_data: essential data to process
      - confidence: solver's confidence level
      - processing_hints: suggestions for processing

      YOUR TASK: Based on the processing_hints and your analysis:
      1. Validate the solution for correctness
      2. Refine or improve the result if needed
      3. Transform the output into a more useful format
      4. Provide final assessment

      OUTPUT FORMAT: You MUST respond with valid JSON that follows this exact schema:
      {
        "validation_status": "valid|invalid|needs_revision",
        "refined_result": "improved or validated result",
        "improvements_made": ["list of improvements or validations performed"],
        "final_assessment": "overall assessment of the result",
        "quality_score": number between 0-1
      }
    model: "gpt-4" # Используем более мощную модель для валидации и улучшения
    temperature: 0.1
    max_tokens: 1200
    response_format:
      type: "json"
      description: "Structured result processing output"
      json_schema:
        type: "object"
        properties:
          validation_status:
            type: "string"
            enum: ["valid", "invalid", "needs_revision"]
            description: "Validation result"
          refined_result:
            type: "string"
            description: "Refined or validated result"
          improvements_made:
            type: "array"
            items:
              type: "string"
            description: "Improvements or validations performed"
          final_assessment:
            type: "string"
            description: "Overall assessment"
          quality_score:
            type: "number"
            minimum: 0
            maximum: 1
            description: "Final quality score"
        required:
          [
            "validation_status",
            "refined_result",
            "final_assessment",
            "quality_score",
          ]
      examples:
        - |
          {
            "validation_status": "valid",
            "refined_result": "The area of a circle with radius 5 is approximately 78.54 square units (using π ≈ 3.14159)",
            "improvements_made": ["added precision to π value", "included units in result"],
            "final_assessment": "Solution is mathematically correct with improved precision and clarity",
            "quality_score": 0.98
          }
